(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27dd62a8"],{"230c":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container"},[n("van-nav-bar",{staticClass:"app-nav-bar",attrs:{"left-arrow":"",title:"文章详情"},on:{"click-left":function(e){return t.$router.back()}}}),n("div",{staticClass:"article-wrap"},[n("h1",{staticClass:"title"},[t._v(t._s(t.article.title))]),n("van-cell",{staticClass:"user-info",attrs:{center:""}},[n("div",{staticClass:"name",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.article.aut_name))]),n("van-image",{staticClass:"avatar",attrs:{slot:"icon",round:"",src:t.article.aut_photo,fit:"cover"},slot:"icon"}),n("div",{staticClass:"pubdate",attrs:{slot:"label"},slot:"label"},[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))]),n("van-button",{staticClass:"follow-btn",attrs:{round:"",icon:t.article.is_followed?"":"plus",size:"small",type:t.article.is_followed?"primary":"info",loading:t.isFollowLoading},on:{click:t.onFollow}},[t._v(t._s(t.article.is_followed?"已关注":"关注"))])],1),n("div",{ref:"article_content",staticClass:"markdown-body",domProps:{innerHTML:t._s(t.article.content)}}),n("comment-list",{attrs:{source:t.articleId,list:t.commentList},on:{"update-total-count":function(e){t.totalCommentCount=e},"reply-click":t.onReplyClick}})],1),n("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.isPostShow,callback:function(e){t.isPostShow=e},expression:"isPostShow"}},[n("post-comment",{attrs:{target:t.articleId},on:{"post-success":t.onPostSuccess}})],1),n("div",{staticClass:"article-bottom"},[n("van-button",{staticClass:"comment-btn",attrs:{type:"default",round:"",size:"small"},on:{click:function(e){t.isPostShow=!0}}},[t._v("写评论")]),n("van-icon",{attrs:{name:"comment-o",info:t.totalCommentCount,color:"#777"}}),n("van-icon",{attrs:{color:"yellow",name:t.article.is_collected?"star":"star-o"},on:{click:t.onCollect}}),n("van-icon",{attrs:{color:"red",name:1===t.article.attitude?"good-job":"good-job-o"},on:{click:t.onLike}}),n("van-icon",{attrs:{name:"share",color:"#777777"}})],1),n("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.isReplyShow,callback:function(e){t.isReplyShow=e},expression:"isReplyShow"}},[t.isReplyShow?n("reply-comment",{attrs:{comment:t.commentReply,articleId:t.articleId},on:{close:function(e){t.isReplyShow=!1}}}):t._e()],1)],1)},o=[],a=(n("4160"),n("a9e3"),n("159b"),n("96cf"),n("1da1")),c=(n("e6f2"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-list"},[n("van-cell",{attrs:{title:"全部评论"}}),n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,r){return n("comment-item",{key:r,attrs:{comment:e},on:{"reply-click":function(e){return t.$emit("reply-click",e)}}})})),1)],1)}),i=[],s=(n("d3b7"),n("25f0"),n("2909")),l=n("b775"),u=function(t){return Object(l["a"])({method:"GET",url:"/app/v1_0/comments",params:t})},m=function(t){return Object(l["a"])({method:"POST",url:"/app/v1_0/comment/likings",data:{target:t}})},d=function(t){return Object(l["a"])({method:"DELETE",url:"/app/v1_0/comment/likings/".concat(t)})},f=function(t){return Object(l["a"])({method:"POST",url:"/app/v1_0/comments",data:t})},p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"comment-item"},[n("van-image",{staticClass:"avatar",attrs:{slot:"icon",width:"36",height:"36",round:"",src:t.comment.aut_photo,fix:"cover"},slot:"icon"}),n("div",{staticClass:"title-wrap",attrs:{slot:"title"},slot:"title"},[n("div",{staticClass:"title-wrap-top"},[n("div",{staticClass:"user-name"},[t._v(t._s(t.comment.aut_name))]),n("div",{staticClass:"like-wrap"},[n("van-icon",{staticClass:"like-icon",attrs:{name:t.comment.is_liking?"like":"like-o",color:"hotpink"},on:{click:t.onCommentLike}}),n("span",{staticClass:"like-count"},[t._v(t._s(t.comment.reply_count))])],1)]),n("div",{staticClass:"content",attrs:{slot:"label"},slot:"label"},[t._v(t._s(t.comment.content)+" ")]),n("div",{staticClass:"bottom-wrap"},[n("span",{staticClass:"pubdate"},[t._v(t._s(t._f("dateTime")(t.comment.pubdate)))]),n("van-button",{staticClass:"reply-btn",attrs:{round:"",type:"info",size:"mini"},on:{click:function(e){return t.$emit("reply-click",t.comment)}}},[t._v(t._s(t.comment.like_count)+"回复")])],1)])],1)},b=[],v={name:"CommentItem",props:{comment:{type:Object,required:!0}},methods:{onCommentLike:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.comment.com_id.toString(),!t.comment.is_liking){e.next=7;break}return e.next=4,d(n);case 4:t.comment.reply_count--,e.next=10;break;case 7:return e.next=9,m(n);case 9:t.comment.reply_count++;case 10:t.comment.is_liking=!t.comment.is_liking,t.$toast.success({icon:"".concat(t.comment.is_liking?"like":"like-o"),message:"".concat(t.comment.is_liking?"添加喜欢":"取消喜欢"),duration:1e3});case 12:case"end":return e.stop()}}),e)})))()}}},h=v,g=(n("6c9c"),n("2877")),_=Object(g["a"])(h,p,b,!1,null,"2b1f6e2c",null),w=_.exports,y={name:"CommentList",components:{CommentItem:w},data:function(){return{loading:!1,finished:!1,offset:null,limit:10}},props:{source:{type:[Number,String,Object],required:!0},type:{type:String,default:"a"},list:{type:Array,default:function(){return[]}}},methods:{onLoad:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u({type:t.type,source:t.source.toString(),offset:t.offset,limit:t.limit});case 2:r=e.sent,o=r.data,t.$emit("update-total-count",o.data.total_count),a=o.data.results,(n=t.list).push.apply(n,Object(s["a"])(a)),t.loading=!1,a.length?t.offset=o.data.last_id:t.finished=!0;case 9:case"end":return e.stop()}}),e)})))()}}},k=y,C=Object(g["a"])(k,c,i,!1,null,"a8e1bc9c",null),O=C.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-comment"},[n("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"50",placeholder:"请输入留言","show-word-limit":""},model:{value:t.message,callback:function(e){t.message="string"===typeof e?e.trim():e},expression:"message"}}),n("div",{staticClass:"all-btn"},[n("van-button",{staticClass:"post-btn",attrs:{type:"default",size:"small",round:"",disabled:""===t.message},on:{click:t.onPost}},[t._v("发布")]),n("van-button",{staticClass:"set-btn",attrs:{type:"default",size:"small",disabled:""===t.message,round:""},on:{click:t.onSet}},[t._v("重置")])],1)],1)},S=[],x={name:"PostComment",data:function(){return{message:""}},props:{target:{type:[Number,String,Object],required:!0},articleId:{type:[Number,String,Object],default:null}},methods:{onPost:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$toast.loading({message:"loading...",forbidClick:!0}),e.next=3,f({target:t.target.toString(),content:t.message,art_id:t.articleId?t.articleId.toString():null});case 3:n=e.sent,r=n.data,console.log(r),t.$emit("post-success",r.data.new_obj),t.$toast.success("发布成功"),t.message="";case 9:case"end":return e.stop()}}),e)})))()},onSet:function(){this.message=""}}},E=x,I=(n("ab5c"),Object(g["a"])(E,j,S,!1,null,"7aa51c8c",null)),T=I.exports,A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-reply"},[n("van-nav-bar",{attrs:{title:t.comment.reply_count+"条回复"}},[n("van-icon",{attrs:{slot:"left",name:"cross"},on:{click:function(e){return t.$emit("close")}},slot:"left"})],1),n("comment-Item",{attrs:{comment:t.comment}}),n("van-cell",{attrs:{title:"所有回复"}}),n("comment-List",{attrs:{source:t.comment.com_id,type:"c",list:t.commentList}}),n("div",{staticClass:"article-bottom"},[n("van-button",{staticClass:"comment-btn",attrs:{type:"default",round:"",size:"small"},on:{click:function(e){t.isPostShow=!0}}},[t._v("写评论")])],1),n("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.isPostShow,callback:function(e){t.isPostShow=e},expression:"isPostShow"}},[n("post-comment",{attrs:{target:t.comment.com_id,articleId:t.articleId},on:{"post-success":t.onPostSuccess}})],1)],1)},R=[],P={name:"CommentReply",components:{commentItem:w,commentList:O,postComment:T},data:function(){return{isPostShow:!1,commentList:[]}},props:{comment:{type:Object,required:!0},articleId:{type:[Number,String,Object],required:!0}},methods:{onPostSuccess:function(t){this.commentList.unshift(t),this.isPostShow=!1,this.comment.reply_count++}}},L=P,N=(n("eb53"),Object(g["a"])(L,A,R,!1,null,"11d6b22e",null)),$=N.exports,G=n("2423"),F=n("28a2"),z=n("c24f"),q={name:"ArticleIndex",components:{CommentList:O,postComment:T,replyComment:$},props:{articleId:{type:[Number,String,Object],required:!0}},data:function(){return{article:{},isFollowLoading:!1,isPostShow:!1,commentList:[],totalCommentCount:0,isReplyShow:!1,commentReply:{}}},computed:{},watch:{},created:function(){this.loadArticle()},mounted:function(){},methods:{loadArticle:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(G["e"])(t.articleId);case 2:n=e.sent,r=n.data,t.article=r.data,t.$nextTick((function(){t.handlePreviewImage()}));case 6:case"end":return e.stop()}}),e)})))()},handlePreviewImage:function(){var t=this.$refs.article_content,e=t.querySelectorAll("img"),n=[];e.forEach((function(t,e){n.push(t.src),t.onclick=function(){Object(F["a"])({images:n,startPosition:e})}}))},onFollow:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isFollowLoading=!0,!t.article.is_followed){e.next=6;break}return e.next=4,Object(z["b"])(t.article.aut_id);case 4:e.next=8;break;case 6:return e.next=8,Object(z["a"])(t.article.aut_id);case 8:t.isFollowLoading=!1,t.article.is_followed=!t.article.is_followed;case 10:case"end":return e.stop()}}),e)})))()},onCollect:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$toast.loading({message:"Loading...",forbidClick:!0}),!t.article.is_collected){e.next=6;break}return e.next=4,Object(G["c"])(t.articleId);case 4:e.next=8;break;case 6:return e.next=8,Object(G["a"])(t.articleId);case 8:t.article.is_collected=!t.article.is_collected,t.$toast.success({message:"".concat(t.article.is_collected?"收藏成功":"取消收藏"),duration:1e3});case 10:case"end":return e.stop()}}),e)})))()},onLike:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$toast.loading({message:"Loading...",forbidClick:!0}),1!==t.article.attitude){e.next=7;break}return e.next=4,Object(G["d"])(t.articleId);case 4:t.article.attitude=-1,e.next=10;break;case 7:return e.next=9,Object(G["b"])(t.articleId);case 9:t.article.attitude=1;case 10:t.$toast.success({message:"".concat(1===t.article.attitude?"添加喜欢":"取消喜欢"),duration:1e3});case 11:case"end":return e.stop()}}),e)})))()},onPostSuccess:function(t){console.log(t),this.commentList.unshift(t),this.isPostShow=!1,this.totalCommentCount++},onReplyClick:function(t){this.commentReply=t,this.isReplyShow=!0}}},M=q,D=(n("3073"),Object(g["a"])(M,r,o,!1,null,"8e58a8a8",null));e["default"]=D.exports},2423:function(t,e,n){"use strict";n.d(e,"f",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return l}));var r=n("b775"),o=function(t){return Object(r["a"])({method:"GET",url:"/app/v1_1/articles",params:t})},a=function(t){return Object(r["a"])({method:"GET",url:"/app/v1_0/articles/".concat(t)})},c=function(t){return Object(r["a"])({method:"POST",url:"/app/v1_0/article/collections",data:{target:t}})},i=function(t){return Object(r["a"])({method:"DELETE",url:"/app/v1_0/article/collections/".concat(t)})},s=function(t){return Object(r["a"])({method:"POST",url:"/app/v1_0/article/likings",data:{target:t}})},l=function(t){return Object(r["a"])({method:"DELETE",url:"/app/v1_0/article/likings/".concat(t)})}},"25f0":function(t,e,n){"use strict";var r=n("6eeb"),o=n("825a"),a=n("d039"),c=n("ad6d"),i="toString",s=RegExp.prototype,l=s[i],u=a((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),m=l.name!=i;(u||m)&&r(RegExp.prototype,i,(function(){var t=o(this),e=String(t.source),n=t.flags,r=String(void 0===n&&t instanceof RegExp&&!("flags"in s)?c.call(t):n);return"/"+e+"/"+r}),{unsafe:!0})},2909:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t){if(Array.isArray(t))return r(t)}n.d(e,"a",(function(){return s}));n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("d3b7"),n("3ca3"),n("ddb0");function a(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}n("fb6a"),n("25f0");function c(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return o(t)||a(t)||c(t)||i()}},3073:function(t,e,n){"use strict";var r=n("dfa9"),o=n.n(r);o.a},"4df4":function(t,e,n){"use strict";var r=n("0366"),o=n("7b0b"),a=n("9bdd"),c=n("e95a"),i=n("50c4"),s=n("8418"),l=n("35a1");t.exports=function(t){var e,n,u,m,d,f,p=o(t),b="function"==typeof this?this:Array,v=arguments.length,h=v>1?arguments[1]:void 0,g=void 0!==h,_=l(p),w=0;if(g&&(h=r(h,v>2?arguments[2]:void 0,2)),void 0==_||b==Array&&c(_))for(e=i(p.length),n=new b(e);e>w;w++)f=g?h(p[w],w):p[w],s(n,w,f);else for(m=_.call(p),d=m.next,n=new b;!(u=d.call(m)).done;w++)f=g?a(m,h,[u.value,w],!0):u.value,s(n,w,f);return n.length=w,n}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("1d80"),o=n("5899"),a="["+o+"]",c=RegExp("^"+a+a+"*"),i=RegExp(a+a+"*$"),s=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(c,"")),2&t&&(n=n.replace(i,"")),n}};t.exports={start:s(1),end:s(2),trim:s(3)}},"6c9c":function(t,e,n){"use strict";var r=n("8da2"),o=n.n(r);o.a},7156:function(t,e,n){var r=n("861d"),o=n("d2bb");t.exports=function(t,e,n){var a,c;return o&&"function"==typeof(a=e.constructor)&&a!==n&&r(c=a.prototype)&&c!==n.prototype&&o(t,c),t}},"8da2":function(t,e,n){},a630:function(t,e,n){var r=n("23e7"),o=n("4df4"),a=n("1c7e"),c=!a((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:c},{from:o})},a9e3:function(t,e,n){"use strict";var r=n("83ab"),o=n("da84"),a=n("94ca"),c=n("6eeb"),i=n("5135"),s=n("c6b6"),l=n("7156"),u=n("c04e"),m=n("d039"),d=n("7c73"),f=n("241c").f,p=n("06cf").f,b=n("9bf2").f,v=n("58a8").trim,h="Number",g=o[h],_=g.prototype,w=s(d(_))==h,y=function(t){var e,n,r,o,a,c,i,s,l=u(t,!1);if("string"==typeof l&&l.length>2)if(l=v(l),e=l.charCodeAt(0),43===e||45===e){if(n=l.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+l}for(a=l.slice(2),c=a.length,i=0;i<c;i++)if(s=a.charCodeAt(i),s<48||s>o)return NaN;return parseInt(a,r)}return+l};if(a(h,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var k,C=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof C&&(w?m((function(){_.valueOf.call(n)})):s(n)!=h)?l(new g(y(e)),n,C):y(e)},O=r?f(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j=0;O.length>j;j++)i(g,k=O[j])&&!i(C,k)&&b(C,k,p(g,k));C.prototype=_,_.constructor=C,c(o,h,C)}},ab5c:function(t,e,n){"use strict";var r=n("f8b7"),o=n.n(r);o.a},c24f:function(t,e,n){"use strict";n.d(e,"l",(function(){return a})),n.d(e,"m",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return u})),n.d(e,"k",(function(){return m})),n.d(e,"o",(function(){return d})),n.d(e,"n",(function(){return f})),n.d(e,"j",(function(){return p})),n.d(e,"d",(function(){return b})),n.d(e,"f",(function(){return v})),n.d(e,"i",(function(){return h})),n.d(e,"h",(function(){return g})),n.d(e,"g",(function(){return _}));var r=n("b775"),o=n("4360"),a=function(t){return Object(r["a"])({method:"POST",url:"/app/v1_0/authorizations",data:t})},c=function(t){return Object(r["a"])({method:"GET",url:"/app/v1_0/sms/codes/".concat(t)})},i=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user",headers:{Authorization:"Bearer ".concat(o["a"].state.user.token)}})},s=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/channels"})},l=function(t){return Object(r["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:t}})},u=function(t){return Object(r["a"])({method:"DELETE",url:"/app/v1_0/user/followings/".concat(t)})},m=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/profile"})},d=function(t){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:t})},f=function(t){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:t})},p=function(t){return Object(r["a"])({method:"GET",url:"/app/v1_0/users/".concat(t)})},b=function(t){return Object(r["a"])({methods:"GET",url:"/app/v1_0/user/articles",params:t})},v=function(t){return Object(r["a"])({methods:"GET",url:"/app/v1_0/article/collections",params:t})},h=function(t){return Object(r["a"])({methods:"GET",url:"/app/v1_0/user/histories",params:t})},g=function(t){return Object(r["a"])({methods:"GET",url:"/app/v1_0/user/followings",params:t})},_=function(t){return Object(r["a"])({methods:"GET",url:"/app/v1_0/user/followers",params:t})}},dfa9:function(t,e,n){},e6f2:function(t,e,n){},eb53:function(t,e,n){"use strict";var r=n("f077"),o=n.n(r);o.a},f077:function(t,e,n){},f8b7:function(t,e,n){},fb6a:function(t,e,n){"use strict";var r=n("23e7"),o=n("861d"),a=n("e8b5"),c=n("23cb"),i=n("50c4"),s=n("fc6a"),l=n("8418"),u=n("b622"),m=n("1dde"),d=n("ae40"),f=m("slice"),p=d("slice",{ACCESSORS:!0,0:0,1:2}),b=u("species"),v=[].slice,h=Math.max;r({target:"Array",proto:!0,forced:!f||!p},{slice:function(t,e){var n,r,u,m=s(this),d=i(m.length),f=c(t,d),p=c(void 0===e?d:e,d);if(a(m)&&(n=m.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?o(n)&&(n=n[b],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return v.call(m,f,p);for(r=new(void 0===n?Array:n)(h(p-f,0)),u=0;f<p;f++,u++)f in m&&l(r,u,m[f]);return r.length=u,r}})}}]);
//# sourceMappingURL=chunk-27dd62a8.dfad36dc.js.map