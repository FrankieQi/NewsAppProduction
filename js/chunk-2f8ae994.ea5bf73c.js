(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f8ae994"],{2422:function(e,t,s){"use strict";var r=s("9ce6"),n=s.n(r);n.a},"4d63":function(e,t,s){var r=s("83ab"),n=s("da84"),a=s("94ca"),i=s("7156"),c=s("9bf2").f,o=s("241c").f,h=s("44e7"),u=s("ad6d"),l=s("9f7f"),f=s("6eeb"),d=s("d039"),p=s("69f3").set,g=s("2626"),v=s("b622"),m=v("match"),b=n.RegExp,x=b.prototype,w=/a/g,k=/a/g,S=new b(w)!==w,O=l.UNSUPPORTED_Y,y=r&&a("RegExp",!S||O||d((function(){return k[m]=!1,b(w)!=w||b(k)==k||"/a/i"!=b(w,"i")})));if(y){var H=function(e,t){var s,r=this instanceof H,n=h(e),a=void 0===t;if(!r&&n&&e.constructor===H&&a)return e;S?n&&!a&&(e=e.source):e instanceof H&&(a&&(t=u.call(e)),e=e.source),O&&(s=!!t&&t.indexOf("y")>-1,s&&(t=t.replace(/y/g,"")));var c=i(S?new b(e,t):b(e,t),r?this:x,H);return O&&s&&p(c,{sticky:s}),c},_=function(e){e in H||c(H,e,{configurable:!0,get:function(){return b[e]},set:function(t){b[e]=t}})},j=o(b),T=0;while(j.length>T)_(j[T++]);x.constructor=H,H.prototype=x,f(n,"RegExp",H)}g("RegExp")},"8a71":function(e,t,s){},"9ce6":function(e,t,s){},c81e:function(e,t,s){"use strict";var r=s("8a71"),n=s.n(r);n.a},efe3:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search_container"},[s("form",{attrs:{action:"/"}},[s("van-search",{attrs:{placeholder:"请输入搜索关键词","show-action":"",shape:"round",background:"#3296fa"},on:{search:function(t){return e.onSearch(e.searchText)},cancel:function(t){return e.$router.back()},focus:function(t){e.isResultShow=!1}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e.isResultShow?s("search-result",{attrs:{"search-text":e.searchText}}):e.searchText?s("search-suggestion",{attrs:{"search-text":e.searchText},on:{search:e.onSearch}}):s("search-history",{attrs:{"search-histories":e.searchHistories},on:{search:e.onSearch,"update-histories":function(t){e.searchHistories=t}}})],1)},n=[],a=(s("c975"),s("a434"),s("96cf"),s("1da1")),i=s("5530"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-suggestion"},e._l(e.suggestions,(function(t,r){return s("van-cell",{key:r,attrs:{icon:"search"},on:{click:function(s){return e.$emit("search",t)}}},[s("div",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.highight(t))},slot:"title"})])})),1)},o=[],h=(s("4d63"),s("ac1f"),s("25f0"),s("5319"),s("b775")),u=s("4360"),l=function(e){return Object(h["a"])({methods:"GET",url:"/api/v1/news/search",params:e,headers:{token:"".concat(u["a"].state.user.token)}})},f=(s("2ef0"),{name:"search-suggestion",data:function(){return{suggestions:[]}},props:{searchText:{type:String,required:!0}},methods:{highight:function(e){return e.replace(new RegExp(this.searchText,"gi"),'<span style="color: #3296fa">'.concat(this.searchText,"</span>"))}}}),d=f,p=s("2877"),g=Object(p["a"])(d,c,o,!1,null,"5d8462e5",null),v=g.exports,m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-history"},[s("van-cell",{attrs:{title:"历史记录"}},[e.isDeleteShow?s("div",[s("span",{on:{click:function(t){return e.$emit("update-histories",[])}}},[e._v("全部删除")]),e._v(" "),s("span",{on:{click:function(t){e.isDeleteShow=!1}}},[e._v("完成")])]):s("van-icon",{attrs:{name:"delete"},on:{click:function(t){e.isDeleteShow=!0}}})],1),e._l(e.searchHistories,(function(t,r){return s("van-cell",{key:r,attrs:{title:t},on:{click:function(s){return e.onDelete(t,r)}}},[s("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.isDeleteShow,expression:"isDeleteShow"}],attrs:{name:"close"}})],1)}))],2)},b=[],x=s("d17a"),w={name:"search-history",props:{searchHistories:{type:Array,required:!0}},data:function(){return{isDeleteShow:!1}},methods:{onDelete:function(e,t){if(this.isDeleteShow)return this.searchHistories.splice(t,1),void Object(x["b"])("search-histories",this.searchHistories);this.$emit("search",e)}}},k=w,S=Object(p["a"])(k,m,b,!1,null,"8cf52174",null),O=S.exports,y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-result"},[s("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e,t){return s("van-cell",{key:t,attrs:{title:e.title,to:{name:"article",params:{news_id:e.id}}}})})),1)],1)},H=[],_=s("2909"),j=s("2f62"),T={name:"search-result",data:function(){return{list:[],loading:!1,finished:!1,page:1,perPage:10}},computed:Object(i["a"])({},Object(j["b"])(["user"])),props:{searchText:{type:String,required:!0}},methods:{onLoad:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l({page:e.page,key:e.searchText,token:e.user.token});case 2:r=t.sent,n=r.data,(s=e.list).push.apply(s,Object(_["a"])(n)),e.loading=!1,n.length?e.page++:e.finished=!0;case 7:case"end":return t.stop()}}),t)})))()}}},R=T,E=(s("2422"),Object(p["a"])(R,y,H,!1,null,"42ceb91e",null)),D=E.exports,$={name:"SearchIndex",components:{searchSuggestion:v,searchHistory:O,searchResult:D},computed:Object(i["a"])({},Object(j["b"])(["user"])),data:function(){return{searchText:"",isResultShow:!1,searchHistories:Object(x["a"])("search-histories")||[]}},created:function(){this.loadSearchHistories()},watch:{searchHistories:function(){Object(x["b"])("search-histories",this.searchHistories)}},methods:{onSearch:function(e){this.searchText=e;var t=this.searchHistories.indexOf(e);-1!==t&&this.searchHistories.splice(t,1),this.searchHistories.unshift(e),Object(x["b"])("search-histories",this.searchHistories),this.isResultShow=!0},loadSearchHistories:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=Object(x["a"])("search-histories")||[],e.searchHistories=s;case 2:case"end":return t.stop()}}),t)})))()}}},C=$,P=(s("c81e"),Object(p["a"])(C,r,n,!1,null,"5dfc90e9",null));t["default"]=P.exports}}]);
//# sourceMappingURL=chunk-2f8ae994.ea5bf73c.js.map